<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>stompit.Failover
    </title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="/node-stomp/css/main.css">
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
  </head>
  <body>
    <div class="container">
<h1>stompit.Failover</h1>
<h2 class="function">stompit.Failover(servers, [options])</h2>
<table class="params table table-bordered table-condensed">
  <caption></caption>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="name">servers<span class="default-value"></span></td>
      <td class="type">Array</td>
      <td class="desc">
        <p>List of servers. The first server in the list is the primary server. </p>
        <p>Each element in the array is an Object value containing address and other settings of a server. See <a href="/api/#stompit_connect">stompit.connect</a> function for the list of possible server settings.</p>
      </td>
    </tr>
    <tr>
      <td class="name">options<span class="default-value"></span></td>
      <td class="type">Object</td>
      <td class="desc">
        <table class="params table table-bordered table-condensed">
          <caption></caption>
          <thead>
            <tr>
              <th>Name</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="name">initialReconnectDelay<span class="default-value">10</span></td>
              <td class="type">Number</td>
              <td class="desc">
                <p>Minimum time to wait idle between the call to reconnect and attempting a reconnect.</p>
              </td>
            </tr>
            <tr>
              <td class="name">maxReconnectDelay<span class="default-value">30000</span></td>
              <td class="type">Number</td>
              <td class="desc">
                <p>Maximum time to wait idle between the call to reconnect and attempting a reconnect.</p>
              </td>
            </tr>
            <tr>
              <td class="name">useExponentialBackOff<span class="default-value">true</span></td>
              <td class="type">Boolean</td>
              <td class="desc">
              </td>
            </tr>
            <tr>
              <td class="name">reconnectDelayExponent<span class="default-value">2.0</span></td>
              <td class="type">Number</td>
              <td class="desc">
                <p>Increase the reconnect delay time exponentially for each reconnect attempt. The delay time is reset to the minimum value on establishing a connection.</p>
              </td>
            </tr>
            <tr>
              <td class="name">maxReconnectAttempts<span class="default-value">-1</span></td>
              <td class="type">Number</td>
              <td class="desc">
                <p>Maximum number of <em>attempted</em> re-connections. The value <code>-1</code> disables this limit.</p>
              </td>
            </tr>
            <tr>
              <td class="name">maxReconnects<span class="default-value">-1</span></td>
              <td class="type">Number</td>
              <td class="desc">
                <p>Maximum number of <em>successful</em> re-connections. The value <code>-1</code> disables this limit.</p>
              </td>
            </tr>
            <tr>
              <td class="name">randomize<span class="default-value">true</span></td>
              <td class="type">Boolean</td>
              <td class="desc">
                <p>Randomly choose a server from the server list when reconnecting</p>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  </tbody>
</table>
<p>Usage example:</p>
<pre>var failover = new stompit.Failover([
    {port: 61613, host: 'localhost'},
    {port: 61614, host: '192.168.1.2', connectHeaders:{login:'', passcode:''}},
]);
</pre>
<h2 class="function">Failover.addServer(settings)</h2>
<p>Append to list of servers</p>
<h2 class="function">Failover.connect(callback)</h2>
<table class="params table table-bordered table-condensed">
  <caption></caption>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="name">callback<span class="default-value"></span></td>
      <td class="type">Function</td>
      <td class="desc">
        <p>callback arguments:</p>
        <table class="params table table-bordered table-condensed">
          <caption></caption>
          <thead>
            <tr>
              <th>Name</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="name">error</td>
              <td class="type">Error</td>
              <td class="desc">
              </td>
            </tr>
            <tr>
              <td class="name">client</td>
              <td class="type">stompit.Client</td>
              <td class="desc">
              </td>
            </tr>
            <tr>
              <td class="name">reconnect</td>
              <td class="type">Function</td>
              <td class="desc">
                <p>reconnect to a server and pass a new client object to the callback</p>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  </tbody>
</table>
<p>Usage example:</p>
<pre>failover.connect(function(error, client, reconnect){

    if(error){
        console.log(error);
        return;
    }
    
    client.on('error', function(){
        reconnect();
    });
    
    // do client stuff
});</pre>
      <ul id="side-nav" class="nav nav-stacked nav-pills">
        <li><a href="/node-stomp/api/">stompit</a><a href="/node-stomp/api/#broker">stompit.broker</a><a href="/node-stomp/api/messaging.html">stompit.Messaging</a><a href="/node-stomp/api/failover.html">stompit.Failover</a><a href="/node-stomp/api/#connect">stompit.connect</a><a href="/node-stomp/api/client.html">stompit.Client</a></li>
      </ul>
    </div>
  </body>
</html>